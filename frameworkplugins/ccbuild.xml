<?xml version="1.0" encoding="UTF-8"?>
<project name="FrameWork" default="cc" basedir=".">

	<!-- declare ant4eclipse -->
  <taskdef resource="net/sf/ant4eclipse/antlib.xml" />

	<property name="workspace.path" value="." />
  <property name="java.location" value="C:/APPS/j2sdk_1.5.0_12" />
  <property name="destination.path" value="." />

	<property name="basews" value="${ws}"/>
	<property name="baseos" value="${os}"/>
	<property name="basearch" value="${arch}"/>
	<property name="basenl" value="${nl}"/>
	
	<property name="feature.project.folder" location="com.nokia.s60tools.extensions.framework"/>
	<property name="feature.project.name" value="com.nokia.s60tools.extensions.framework"/>
	<property name="feature.name" value="framework"/>
	<property name="help.project.name" value="com.nokia.carbide.tool.help"/>
	<property name="help.jar.filename" value="${help.project.name}.jar"/>
	<property name="feature.name" value="Framework"/>
	
	<!-- Folder definitions -->
	
	<property name="carbide.int.folder" location="c:/Carbide_internal/plugins"/>
	<property name="carbide.dev.folder" location="c:/Carbide_development/plugins"/>
	<property name="carbide.adt.folder" location="c:/Carbide_ADT/plugins"/>
	<property name="test.sdk.folder" location="com.nokia.s60tools.sdk.tests"/>
	<property name="test.util.folder" location="com.nokia.s60tools.util.tests"/>
	
	<property name="binaries.folder" location="${feature.name}.binaries"/>
	<property name="reports.folder" location="reports"/>
	<property name="reports.emma" location="${reports.folder}/emma"/>
	<property name="instr.folder" location="instr"/>
	
	
	<!-- Target Plugin -->
  <target name="build.plugins" depends="">
	
		<!--<buildPlugin workspace="${workspace.path}" targetPlatformLocation="${carbide.int.folder}" projectname="com.nokia.carbide.tool.help" destDir="${destination.path}" packageAsJar="true">
  			<javacLibraryCompiler>
  					<compilerSettings debug="true" fork="true"/>
  			</javacLibraryCompiler>
  	</buildPlugin>-->
	
  	<!-- Build MultiTestRunner feature -->
  	<buildFeature workspace="${workspace.path}"
               targetPlatformLocation="${carbide.int.folder}"
               projectname="${feature.project.name}"
               buildPluginTarget="build.plugin"
               destDir="${destination.path}" />
  </target>
  
  <target name="feature" depends="">
  
		<copy todir="plugins">
				<fileset dir="C:\hudson\jobs\Framework SDK\workspace\com.nokia.s60tools.sdk\plugins"/>
		</copy>		
		<copy todir="plugins">
				<fileset dir="C:\hudson\jobs\Framework UI\workspace\com.nokia.s60tools.ui\plugins"/>
		</copy>
		<copy todir="plugins">
				<fileset dir="C:\hudson\jobs\Framework Util\workspace\com.nokia.s60tools.util\plugins"/>
		</copy>
				
		<!-- Copy the actual plug-ins to the carbide folders -->
		<copy todir="${carbide.int.folder}" failonerror="true" overwrite="true">
				<fileset dir="plugins"/>
				<fileset dir="C:\hudson\jobs\Framework Testsupport\workspace\com.nokia.s60tools.testsupport\plugins"/>
		</copy>
		<copy todir="${carbide.dev.folder}" failonerror="true" overwrite="true">
				<fileset dir="plugins"/>
				<fileset dir="C:\hudson\jobs\Framework Testsupport\workspace\com.nokia.s60tools.testsupport\plugins"/>
		</copy>
		<copy todir="${carbide.adt.folder}" failonerror="true" overwrite="true">
				<fileset dir="plugins"/>
				<fileset dir="C:\hudson\jobs\Framework Testsupport\workspace\com.nokia.s60tools.testsupport\plugins"/>
		</copy>
		
  </target>
  <target name="create.zip">
  
  	<delete dir="${binaries.folder}/nightly_builds"/>
  	<mkdir dir="${binaries.folder}/nightly_builds"/>
  	
 		 <!-- Zip jars to ActiveObjectAnalyser.zip -->
 		<tstamp>
		   <format property="timestamp" pattern="dd-MM-yyyy" />
		</tstamp> 
 		 
    <zip destfile="${binaries.folder}/nightly_builds/${feature.name}-${timestamp}.zip"
       basedir="."
       includes="plugins/*, features/com.nokia*.*/"/>
  </target>
  
  <!-- Empty target to do nothing --> 
  <target name="build.plugin">
  </target>	
  
	
	<target name="cc" depends="build.plugins, feature, create.zip" description="build.plugins, instrument, run unit tests and analyze code"/>
</project>
